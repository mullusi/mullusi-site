<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCCI Assembly Engine ‚Äî Symbolic Causal Chain Intelligence</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        :root {
            --bg-0: #050508;
            --bg-1: #0a0a10;
            --bg-2: #10101a;
            --bg-3: #18182a;
            --bg-4: #202035;
            --text-0: #ffffff;
            --text-1: #d0d0e0;
            --text-2: #9090a8;
            --text-3: #606078;
            --border: #252540;
            --skill-r: #ff6b6b;
            --skill-s: #4ecdc4;
            --skill-b: #ffe66d;
            --skill-i: #a29bfe;
            --psi: #b388ff;
            --success: #69f0ae;
            --warning: #ffab40;
            --error: #ff5252;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-0);
            color: var(--text-1);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(180deg, var(--bg-2) 0%, var(--bg-0) 100%);
            padding: 2rem;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }

        .header-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 300;
            letter-spacing: 0.3em;
            color: var(--text-0);
            margin-bottom: 0.25rem;
        }

        .header .subtitle {
            font-size: 0.85rem;
            color: var(--text-2);
        }

        /* Main Layout */
        .main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        /* Section */
        .section {
            margin-bottom: 3rem;
        }

        .section-title {
            font-size: 0.7rem;
            font-weight: 700;
            letter-spacing: 0.2em;
            color: var(--psi);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-title::before,
        .section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border), transparent);
        }

        /* Formula Card */
        .formula-card {
            background: var(--bg-2);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }

        .formula-card.highlight {
            border-color: var(--psi);
            box-shadow: 0 0 40px -15px var(--psi);
        }

        .formula-label {
            font-size: 0.65rem;
            font-weight: 700;
            letter-spacing: 0.15em;
            color: var(--psi);
            margin-bottom: 1rem;
        }

        .formula-main {
            font-size: 1.2rem;
            text-align: center;
            padding: 1.5rem;
            background: var(--bg-1);
            border-radius: 8px;
            margin-bottom: 1rem;
            overflow-x: auto;
        }

        .formula-desc {
            font-size: 0.9rem;
            color: var(--text-2);
            line-height: 1.7;
        }

        /* Skill Cards */
        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .skill-card {
            background: var(--bg-2);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .skill-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px -20px rgba(0,0,0,0.5);
        }

        .skill-card.r-int { --skill-color: var(--skill-r); }
        .skill-card.s-harm { --skill-color: var(--skill-s); }
        .skill-card.b-pred { --skill-color: var(--skill-b); }
        .skill-card.i-prop { --skill-color: var(--skill-i); }

        .skill-card:hover {
            border-color: var(--skill-color);
        }

        .skill-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(var(--skill-color-rgb), 0.1), transparent);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .skill-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: var(--bg-3);
            border: 2px solid var(--skill-color);
            color: var(--skill-color);
        }

        .skill-title-group {
            flex: 1;
        }

        .skill-notation {
            font-family: 'Times New Roman', serif;
            font-size: 1rem;
            font-style: italic;
            color: var(--skill-color);
            margin-bottom: 0.25rem;
        }

        .skill-name {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-0);
        }

        .skill-role {
            font-size: 0.7rem;
            color: var(--text-3);
            letter-spacing: 0.1em;
        }

        .skill-body {
            padding: 1.5rem;
        }

        .skill-formula {
            background: var(--bg-1);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            text-align: center;
            font-size: 0.95rem;
            overflow-x: auto;
        }

        .skill-function {
            margin-bottom: 1rem;
        }

        .skill-function-label {
            font-size: 0.65rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            color: var(--text-3);
            margin-bottom: 0.5rem;
        }

        .skill-function-text {
            font-size: 0.85rem;
            color: var(--text-1);
            line-height: 1.6;
        }

        .skill-example {
            background: var(--bg-3);
            border-radius: 8px;
            padding: 1rem;
            border-left: 3px solid var(--skill-color);
        }

        .skill-example-label {
            font-size: 0.6rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            color: var(--skill-color);
            margin-bottom: 0.5rem;
        }

        .skill-example-text {
            font-size: 0.8rem;
            color: var(--text-2);
            line-height: 1.5;
        }

        /* Assembly Pipeline */
        .pipeline-container {
            background: var(--bg-2);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
        }

        .pipeline-stages {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .pipeline-stage {
            flex: 1;
            min-width: 120px;
            text-align: center;
            padding: 1rem;
            background: var(--bg-3);
            border-radius: 12px;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .pipeline-stage.active {
            border-color: var(--psi);
            background: rgba(179, 136, 255, 0.1);
        }

        .pipeline-stage.completed {
            border-color: var(--success);
        }

        .pipeline-stage-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .pipeline-stage-name {
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-1);
        }

        .pipeline-arrow {
            color: var(--text-3);
            font-size: 1.2rem;
        }

        .pipeline-controls {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .btn {
            background: var(--bg-3);
            border: 1px solid var(--border);
            color: var(--text-1);
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.8rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover { border-color: var(--psi); }
        .btn.primary { background: var(--psi); color: #000; border-color: var(--psi); }

        .pipeline-output {
            background: var(--bg-1);
            border-radius: 12px;
            min-height: 300px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1px;
            overflow: hidden;
        }

        @media (max-width: 800px) {
            .pipeline-output {
                grid-template-columns: 1fr;
            }
        }

        .output-panel {
            background: var(--bg-2);
            padding: 1rem;
        }

        .output-panel-title {
            font-size: 0.65rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            color: var(--text-3);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .output-panel-title::before {
            content: '‚óà';
            color: var(--psi);
        }

        /* Assembly Log */
        .assembly-log {
            font-family: 'SF Mono', monospace;
            font-size: 0.75rem;
            max-height: 250px;
            overflow-y: auto;
        }

        .log-entry {
            padding: 0.4rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.03);
            display: flex;
            gap: 0.75rem;
        }

        .log-skill {
            min-width: 60px;
            font-weight: 600;
        }

        .log-skill.r { color: var(--skill-r); }
        .log-skill.s { color: var(--skill-s); }
        .log-skill.b { color: var(--skill-b); }
        .log-skill.i { color: var(--skill-i); }

        .log-message {
            color: var(--text-2);
            flex: 1;
        }

        /* Component Visualization */
        .component-viz {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .component-item {
            background: var(--bg-3);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.75rem;
            transition: all 0.3s ease;
        }

        .component-item.assembling {
            border-color: var(--psi);
            box-shadow: 0 0 15px -5px var(--psi);
        }

        .component-item.assembled {
            border-color: var(--success);
        }

        .component-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .component-name {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-0);
        }

        .component-type {
            font-size: 0.6rem;
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            background: var(--bg-4);
            color: var(--text-2);
        }

        .component-meta {
            font-size: 0.7rem;
            color: var(--text-3);
        }

        /* Constraint Checker */
        .constraint-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .constraint-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
        }

        .constraint-status {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
        }

        .constraint-status.pass { background: var(--success); color: #000; }
        .constraint-status.fail { background: var(--error); color: #fff; }
        .constraint-status.pending { background: var(--text-3); color: var(--bg-0); }

        .constraint-name {
            flex: 1;
            color: var(--text-2);
        }

        .constraint-value {
            color: var(--text-1);
            font-family: monospace;
        }

        /* Result Display */
        .result-symbol {
            background: var(--bg-3);
            border: 2px solid var(--success);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
        }

        .result-symbol-name {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--success);
            margin-bottom: 0.5rem;
        }

        .result-behaviors {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
        }

        .result-behavior {
            font-size: 0.7rem;
            background: rgba(105, 240, 174, 0.1);
            border: 1px solid var(--success);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            color: var(--success);
        }

        /* Assembly Scenarios */
        .scenario-selector {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .scenario-btn {
            background: var(--bg-3);
            border: 1px solid var(--border);
            color: var(--text-2);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.75rem;
            transition: all 0.2s;
        }

        .scenario-btn:hover, .scenario-btn.active {
            border-color: var(--psi);
            color: var(--psi);
        }

        /* Math rendering */
        .katex { font-size: 1em; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-0); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

        /* Animation */
        @keyframes pulse-border {
            0%, 100% { border-color: var(--psi); }
            50% { border-color: transparent; }
        }

        .assembling {
            animation: pulse-border 1s infinite;
        }

        /* Relationship Graph */
        .rel-graph {
            width: 100%;
            height: 200px;
            background: var(--bg-1);
            border-radius: 8px;
            margin-top: 1rem;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem;
            border-top: 1px solid var(--border);
            margin-top: 2rem;
        }

        .footer-symbol {
            font-size: 1.5rem;
            color: var(--psi);
            margin-bottom: 0.5rem;
        }

        .footer-text {
            font-size: 0.75rem;
            color: var(--text-3);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-icon">‚öô</div>
        <h1>SYMBOLIC ASSEMBLY ENGINE</h1>
        <p class="subtitle">SCCI Skills for Causal Chain Construction ‚Äî Template-Free Assembly</p>
    </header>

    <main class="main">
        <!-- Assembly Formula -->
        <section class="section">
            <div class="section-title">ASSEMBLY FORMULA</div>
            
            <div class="formula-card highlight">
                <div class="formula-label">SYMBOLIC ASSEMBLY OPERATOR</div>
                <div class="formula-main">
                    $$\text{Assemble}(S_{\text{new}}) = \mathcal{I}_{\text{prop}} \circ \mathcal{B}_{\text{pred}} \circ \mathcal{S}_{\text{harm}} \circ \mathcal{R}_{\text{int}} \left( \text{Comp}(S_{\text{new}}), \text{Def}(S_{\text{new}}) \right)$$
                </div>
                <div class="formula-desc">
                    Assembly synthesizes a new complex symbol $S_{\text{new}}$ by executing four skills in sequence: 
                    <strong>Relationship Integration</strong> establishes structural connections, 
                    <strong>Specification Harmonization</strong> validates constraints, 
                    <strong>Emergent Behavior Prediction</strong> synthesizes new behaviors, and 
                    <strong>Recursive ID Propagation</strong> updates component contexts.
                </div>
            </div>
        </section>

        <!-- Four Skills -->
        <section class="section">
            <div class="section-title">THE FOUR ASSEMBLY SKILLS</div>
            
            <div class="skills-grid">
                <!-- Skill 1: Relationship Integration -->
                <div class="skill-card r-int">
                    <div class="skill-header">
                        <div class="skill-icon">‚ü∑</div>
                        <div class="skill-title-group">
                            <div class="skill-notation">$\mathcal{R}_{\text{int}}$</div>
                            <div class="skill-name">Relationship Integration</div>
                            <div class="skill-role">ORCHESTRATION</div>
                        </div>
                    </div>
                    <div class="skill-body">
                        <div class="skill-formula">
                            $$\mathcal{R}_{\text{int}}: \text{Rel}(C_i) \times \text{Rel}(C_j) \to \text{Arch}(S_{\text{new}})$$
                        </div>
                        <div class="skill-function">
                            <div class="skill-function-label">FUNCTION</div>
                            <div class="skill-function-text">
                                Matches required $\text{Rel}$ of child symbols to establish structural architecture. 
                                No templates ‚Äî only metadata-driven connection discovery.
                            </div>
                        </div>
                        <div class="skill-example">
                            <div class="skill-example-label">EXAMPLE</div>
                            <div class="skill-example-text">
                                Door assembly: Hinge.Rel('Attaches-To-Fixed-Frame') ‚ü∑ Frame.Rel('Accepts-Hinge') ‚Üí Architecture link established
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Skill 2: Specification Harmonization -->
                <div class="skill-card s-harm">
                    <div class="skill-header">
                        <div class="skill-icon">‚äï</div>
                        <div class="skill-title-group">
                            <div class="skill-notation">$\mathcal{S}_{\text{harm}}$</div>
                            <div class="skill-name">Specification Harmonization</div>
                            <div class="skill-role">CONSTRAINT SOLVING</div>
                        </div>
                    </div>
                    <div class="skill-body">
                        <div class="skill-formula">
                            $$\mathcal{S}_{\text{harm}}: \bigwedge_{i,j} \text{Compatible}(\text{Spec}(C_i), \text{Spec}(C_j)) = \top$$
                        </div>
                        <div class="skill-function">
                            <div class="skill-function-label">FUNCTION</div>
                            <div class="skill-function-text">
                                Validates that specifications across interacting components are mutually consistent. 
                                Resolves conflicts, calculates tolerances, propagates constraints.
                            </div>
                        </div>
                        <div class="skill-example">
                            <div class="skill-example-label">EXAMPLE</div>
                            <div class="skill-example-text">
                                Bearing ‚Üí Axle: Bearing.Spec.Diameter ‚àà Axle.Spec.HoleTolerance ¬± 0.02mm ‚Üí ‚úì Harmonized
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Skill 3: Emergent Behavior Prediction -->
                <div class="skill-card b-pred">
                    <div class="skill-header">
                        <div class="skill-icon">‚ö°</div>
                        <div class="skill-title-group">
                            <div class="skill-notation">$\mathcal{B}_{\text{pred}}$</div>
                            <div class="skill-name">Emergent Behavior Prediction</div>
                            <div class="skill-role">COMPLEX SYSTEMS</div>
                        </div>
                    </div>
                    <div class="skill-body">
                        <div class="skill-formula">
                            $$\mathcal{B}_{\text{pred}}: \text{Beh}(S_{\text{new}}) = \text{Rules} \otimes \bigcup_{C} \text{Beh}(C)$$
                        </div>
                        <div class="skill-function">
                            <div class="skill-function-label">FUNCTION</div>
                            <div class="skill-function-text">
                                Synthesizes emergent behaviors by applying physics/domain Rules to combined component behaviors and geometries.
                            </div>
                        </div>
                        <div class="skill-example">
                            <div class="skill-example-label">EXAMPLE</div>
                            <div class="skill-example-text">
                                Blade + Motor ‚Üí Apply(HydrodynamicsRule) ‚Üí Emergent: "Generates-Forward-Thrust ‚àù RPM"
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Skill 4: Recursive ID Propagation -->
                <div class="skill-card i-prop">
                    <div class="skill-header">
                        <div class="skill-icon">‚Üª</div>
                        <div class="skill-title-group">
                            <div class="skill-notation">$\mathcal{I}_{\text{prop}}$</div>
                            <div class="skill-name">Recursive ID Propagation</div>
                            <div class="skill-role">ORGANIZATION</div>
                        </div>
                    </div>
                    <div class="skill-body">
                        <div class="skill-formula">
                            $$\mathcal{I}_{\text{prop}}: \forall C \in \text{Comp}(S), \mathcal{C}(C) \leftarrow \mathcal{C}(C) \cup \{\text{Parent}: S_{\text{new}}\}$$
                        </div>
                        <div class="skill-function">
                            <div class="skill-function-label">FUNCTION</div>
                            <div class="skill-function-text">
                                Updates the Context of all components with the parent's Identity, changing how 
                                the Œ® formula processes them in future evaluations.
                            </div>
                        </div>
                        <div class="skill-example">
                            <div class="skill-example-label">EXAMPLE</div>
                            <div class="skill-example-text">
                                Metal Rod in Telescope: ùíû(Rod) ‚Üê {Role: 'Focus-Adjustment'} ‚Üí Precision Motion Rule activates instead of Structural Support
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Interactive Assembly Pipeline -->
        <section class="section">
            <div class="section-title">INTERACTIVE ASSEMBLY PIPELINE</div>
            
            <div class="pipeline-container">
                <div class="scenario-selector">
                    <button class="scenario-btn active" data-scenario="door">üö™ Door Assembly</button>
                    <button class="scenario-btn" data-scenario="propeller">‚öô Propeller System</button>
                    <button class="scenario-btn" data-scenario="telescope">üî≠ Telescope Mechanism</button>
                    <button class="scenario-btn" data-scenario="engine">üîß Engine Block</button>
                </div>

                <div class="pipeline-stages">
                    <div class="pipeline-stage" data-stage="0" id="stage0">
                        <div class="pipeline-stage-icon">üì•</div>
                        <div class="pipeline-stage-name">Components</div>
                    </div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-stage" data-stage="1" id="stage1">
                        <div class="pipeline-stage-icon" style="color: var(--skill-r);">‚ü∑</div>
                        <div class="pipeline-stage-name">‚Ñõ_int</div>
                    </div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-stage" data-stage="2" id="stage2">
                        <div class="pipeline-stage-icon" style="color: var(--skill-s);">‚äï</div>
                        <div class="pipeline-stage-name">ùíÆ_harm</div>
                    </div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-stage" data-stage="3" id="stage3">
                        <div class="pipeline-stage-icon" style="color: var(--skill-b);">‚ö°</div>
                        <div class="pipeline-stage-name">‚Ñ¨_pred</div>
                    </div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-stage" data-stage="4" id="stage4">
                        <div class="pipeline-stage-icon" style="color: var(--skill-i);">‚Üª</div>
                        <div class="pipeline-stage-name">‚Ñê_prop</div>
                    </div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-stage" data-stage="5" id="stage5">
                        <div class="pipeline-stage-icon" style="color: var(--success);">‚úì</div>
                        <div class="pipeline-stage-name">S_new</div>
                    </div>
                </div>

                <div class="pipeline-controls">
                    <button class="btn primary" id="btnAssemble">‚ñ∂ Run Assembly</button>
                    <button class="btn" id="btnStep">‚è≠ Step</button>
                    <button class="btn" id="btnReset">‚Üª Reset</button>
                </div>

                <div class="pipeline-output">
                    <!-- Components Panel -->
                    <div class="output-panel">
                        <div class="output-panel-title">COMPONENTS & RELATIONSHIPS</div>
                        <div class="component-viz" id="componentViz">
                            <!-- Populated by JS -->
                        </div>
                        <canvas class="rel-graph" id="relGraph"></canvas>
                    </div>

                    <!-- Log & Constraints Panel -->
                    <div class="output-panel">
                        <div class="output-panel-title">ASSEMBLY LOG</div>
                        <div class="assembly-log" id="assemblyLog">
                            <!-- Populated by JS -->
                        </div>

                        <div class="output-panel-title" style="margin-top: 1rem;">CONSTRAINT VALIDATION</div>
                        <div class="constraint-list" id="constraintList">
                            <!-- Populated by JS -->
                        </div>

                        <div id="resultContainer" style="margin-top: 1rem; display: none;">
                            <div class="output-panel-title">ASSEMBLED SYMBOL</div>
                            <div class="result-symbol" id="resultSymbol">
                                <!-- Populated by JS -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Formal Composition -->
        <section class="section">
            <div class="section-title">FORMAL COMPOSITION RULES</div>
            
            <div class="formula-card">
                <div class="formula-label">SKILL COMPOSITION ORDER (NON-COMMUTATIVE)</div>
                <div class="formula-main">
                    $$\mathcal{I}_{\text{prop}} \circ \mathcal{B}_{\text{pred}} \circ \mathcal{S}_{\text{harm}} \circ \mathcal{R}_{\text{int}} \neq \mathcal{R}_{\text{int}} \circ \mathcal{S}_{\text{harm}} \circ \mathcal{B}_{\text{pred}} \circ \mathcal{I}_{\text{prop}}$$
                </div>
                <div class="formula-desc">
                    The skills must execute in a specific order: <strong>Relationships</strong> establish structure, 
                    <strong>Specifications</strong> validate constraints, <strong>Behaviors</strong> emerge from validated structure, 
                    and <strong>Identity</strong> propagates after the complete symbol exists.
                </div>
            </div>

            <div class="skills-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
                <div class="formula-card" style="padding: 1rem;">
                    <div class="formula-label">AXIOM A.1 ‚Äî RELATIONSHIP PRIMACY</div>
                    <div class="formula-main" style="font-size: 0.9rem; padding: 0.75rem;">
                        $$\mathcal{R}_{\text{int}} \text{ precedes all other skills}$$
                    </div>
                    <div class="formula-desc" style="font-size: 0.75rem;">
                        Structure must exist before constraints can be validated.
                    </div>
                </div>
                <div class="formula-card" style="padding: 1rem;">
                    <div class="formula-label">AXIOM A.2 ‚Äî CONSTRAINT GATE</div>
                    <div class="formula-main" style="font-size: 0.9rem; padding: 0.75rem;">
                        $$\mathcal{S}_{\text{harm}} = \bot \implies \text{Assembly fails}$$
                    </div>
                    <div class="formula-desc" style="font-size: 0.75rem;">
                        Incompatible specifications halt the assembly process.
                    </div>
                </div>
                <div class="formula-card" style="padding: 1rem;">
                    <div class="formula-label">AXIOM A.3 ‚Äî EMERGENCE REQUIRES VALIDITY</div>
                    <div class="formula-main" style="font-size: 0.9rem; padding: 0.75rem;">
                        $$\mathcal{B}_{\text{pred}} \text{ requires } \mathcal{S}_{\text{harm}} = \top$$
                    </div>
                    <div class="formula-desc" style="font-size: 0.75rem;">
                        Behaviors only emerge from constraint-valid assemblies.
                    </div>
                </div>
                <div class="formula-card" style="padding: 1rem;">
                    <div class="formula-label">AXIOM A.4 ‚Äî IDENTITY COMPLETENESS</div>
                    <div class="formula-main" style="font-size: 0.9rem; padding: 0.75rem;">
                        $$\mathcal{I}_{\text{prop}} \text{ executes last}$$
                    </div>
                    <div class="formula-desc" style="font-size: 0.75rem;">
                        Context updates require the complete assembled symbol.
                    </div>
                </div>
            </div>
        </section>

        <!-- Integration with Œ® -->
        <section class="section">
            <div class="section-title">INTEGRATION WITH Œ® FORMULA</div>
            
            <div class="formula-card">
                <div class="formula-label">ASSEMBLY AS Œ® INVERSE</div>
                <div class="formula-main">
                    $$\Psi^{-1}(S_{\text{new}}) = \text{Assemble}(\text{Comp}(S_{\text{new}})) \text{ where } \Psi(S_{\text{new}}) \to \mathcal{O}$$
                </div>
                <div class="formula-desc">
                    While Œ® <strong>resolves</strong> symbols into outputs (analysis), Assembly <strong>constructs</strong> symbols from components (synthesis). 
                    Together they form a complete symbolic intelligence cycle: <em>understand ‚Üî create</em>.
                </div>
            </div>

            <div class="formula-card">
                <div class="formula-label">COMPLETE SCCI CYCLE</div>
                <div class="formula-main">
                    $$\text{SCCI} = \Psi \circ \text{Assemble} : \text{Components} \xrightarrow{\text{Assemble}} S_{\text{new}} \xrightarrow{\Psi} \mathcal{O}$$
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-symbol">‚öô</div>
        <div class="footer-text">
            SCCI Assembly Engine ‚Äî Symbolic Causal Chain Intelligence<br>
            <span style="opacity: 0.6;">Template-Free ‚Ä¢ Metadata-Driven ‚Ä¢ Causally Complete</span>
        </div>
    </footer>

    <script>
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // ASSEMBLY SCENARIOS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        const SCENARIOS = {
            door: {
                name: 'Door Assembly',
                targetSymbol: 'Door',
                components: [
                    {
                        id: 'DoorPanel',
                        type: 'Object',
                        def: 'Rectangular barrier panel',
                        rel: ['Accepts-Hinge-Mount', 'Accepts-Handle-Mount', 'Fills-Frame-Opening'],
                        spec: { width: 80, height: 200, thickness: 4, material: 'Wood', weight: 15 },
                        beh: ['Swings-On-Axis', 'Blocks-Passage']
                    },
                    {
                        id: 'Hinge_A',
                        type: 'Object',
                        def: 'Rotational joint mechanism',
                        rel: ['Attaches-To-Fixed-Frame', 'Provides-Rotation-Axis'],
                        spec: { loadCapacity: 25, rotationRange: 180, material: 'Steel' },
                        beh: ['Enables-Rotation', 'Bears-Load']
                    },
                    {
                        id: 'Hinge_B',
                        type: 'Object',
                        def: 'Rotational joint mechanism',
                        rel: ['Attaches-To-Fixed-Frame', 'Provides-Rotation-Axis'],
                        spec: { loadCapacity: 25, rotationRange: 180, material: 'Steel' },
                        beh: ['Enables-Rotation', 'Bears-Load']
                    },
                    {
                        id: 'DoorFrame',
                        type: 'Object',
                        def: 'Fixed structural surround',
                        rel: ['Accepts-Hinge-Attachment', 'Defines-Opening', 'Anchors-To-Wall'],
                        spec: { innerWidth: 82, innerHeight: 202, material: 'Wood', loadCapacity: 100 },
                        beh: ['Supports-Door', 'Defines-Threshold']
                    },
                    {
                        id: 'Handle',
                        type: 'Object',
                        def: 'User grip and latch mechanism',
                        rel: ['Mounts-To-Panel', 'Interfaces-With-Latch'],
                        spec: { gripLength: 12, material: 'Metal' },
                        beh: ['Enables-Grip', 'Controls-Latch']
                    }
                ],
                relationships: [
                    { from: 'Hinge_A', to: 'DoorFrame', type: 'Attaches-To-Fixed-Frame ‚ü∑ Accepts-Hinge-Attachment' },
                    { from: 'Hinge_B', to: 'DoorFrame', type: 'Attaches-To-Fixed-Frame ‚ü∑ Accepts-Hinge-Attachment' },
                    { from: 'Hinge_A', to: 'DoorPanel', type: 'Provides-Rotation-Axis ‚ü∑ Accepts-Hinge-Mount' },
                    { from: 'Hinge_B', to: 'DoorPanel', type: 'Provides-Rotation-Axis ‚ü∑ Accepts-Hinge-Mount' },
                    { from: 'Handle', to: 'DoorPanel', type: 'Mounts-To-Panel ‚ü∑ Accepts-Handle-Mount' },
                    { from: 'DoorPanel', to: 'DoorFrame', type: 'Fills-Frame-Opening ‚ü∑ Defines-Opening' }
                ],
                constraints: [
                    { name: 'Panel fits Frame', check: (c) => c.DoorPanel.spec.width < c.DoorFrame.spec.innerWidth },
                    { name: 'Hinges support weight', check: (c) => (c.Hinge_A.spec.loadCapacity + c.Hinge_B.spec.loadCapacity) >= c.DoorPanel.spec.weight },
                    { name: 'Panel height fits', check: (c) => c.DoorPanel.spec.height < c.DoorFrame.spec.innerHeight },
                    { name: 'Material compatibility', check: (c) => true }
                ],
                emergentBehaviors: [
                    'Opens-And-Closes (Panel swings via Hinges)',
                    'Secures-Passage (Handle controls latch)',
                    'Seals-Opening (Panel fills Frame gap)'
                ],
                contextUpdate: {
                    DoorPanel: 'Role: Primary-Barrier',
                    Hinge_A: 'Role: Upper-Pivot',
                    Hinge_B: 'Role: Lower-Pivot',
                    Handle: 'Role: User-Interface'
                }
            },
            propeller: {
                name: 'Propeller System',
                targetSymbol: 'PropulsionUnit',
                components: [
                    {
                        id: 'Blade_A',
                        type: 'Object',
                        def: 'Airfoil surface for thrust generation',
                        rel: ['Mounts-To-Hub', 'Interacts-With-Fluid'],
                        spec: { length: 30, pitch: 15, material: 'Carbon-Fiber', area: 120 },
                        beh: ['Generates-Lift', 'Experiences-Drag']
                    },
                    {
                        id: 'Blade_B',
                        type: 'Object',
                        def: 'Airfoil surface for thrust generation',
                        rel: ['Mounts-To-Hub', 'Interacts-With-Fluid'],
                        spec: { length: 30, pitch: 15, material: 'Carbon-Fiber', area: 120 },
                        beh: ['Generates-Lift', 'Experiences-Drag']
                    },
                    {
                        id: 'Hub',
                        type: 'Object',
                        def: 'Central mounting point',
                        rel: ['Accepts-Blade-Mount', 'Connects-To-Shaft'],
                        spec: { diameter: 8, material: 'Aluminum', bladeSlots: 3 },
                        beh: ['Transmits-Torque', 'Balances-Forces']
                    },
                    {
                        id: 'Motor',
                        type: 'Object',
                        def: 'Rotational power source',
                        rel: ['Drives-Shaft', 'Receives-Power'],
                        spec: { rpm: 5000, torque: 2.5, power: 500 },
                        beh: ['Generates-Rotation', 'Consumes-Energy']
                    }
                ],
                relationships: [
                    { from: 'Blade_A', to: 'Hub', type: 'Mounts-To-Hub ‚ü∑ Accepts-Blade-Mount' },
                    { from: 'Blade_B', to: 'Hub', type: 'Mounts-To-Hub ‚ü∑ Accepts-Blade-Mount' },
                    { from: 'Hub', to: 'Motor', type: 'Connects-To-Shaft ‚ü∑ Drives-Shaft' }
                ],
                constraints: [
                    { name: 'Hub has enough slots', check: (c) => c.Hub.spec.bladeSlots >= 2 },
                    { name: 'Motor torque sufficient', check: (c) => c.Motor.spec.torque > 1.0 },
                    { name: 'Blade pitch matched', check: (c) => c.Blade_A.spec.pitch === c.Blade_B.spec.pitch }
                ],
                emergentBehaviors: [
                    'Generates-Thrust ‚àù RPM √ó Blade-Area',
                    'Self-Balances (symmetric blade arrangement)',
                    'Converts-Rotational-To-Linear-Motion'
                ],
                contextUpdate: {
                    Blade_A: 'Role: Thrust-Generator-1',
                    Blade_B: 'Role: Thrust-Generator-2',
                    Hub: 'Role: Force-Distributor',
                    Motor: 'Role: Power-Source'
                }
            },
            telescope: {
                name: 'Telescope Mechanism',
                targetSymbol: 'FocusingTelescope',
                components: [
                    {
                        id: 'ObjectiveLens',
                        type: 'Object',
                        def: 'Light-gathering primary optic',
                        rel: ['Positioned-At-Front', 'Focuses-Light'],
                        spec: { diameter: 100, focalLength: 900, material: 'Glass' },
                        beh: ['Refracts-Light', 'Forms-Primary-Image']
                    },
                    {
                        id: 'FocusTube',
                        type: 'Object',
                        def: 'Adjustable tube for focus control',
                        rel: ['Houses-Eyepiece', 'Slides-In-Body'],
                        spec: { travelRange: 50, precision: 0.1 },
                        beh: ['Adjusts-Position', 'Maintains-Alignment']
                    },
                    {
                        id: 'Eyepiece',
                        type: 'Object',
                        def: 'Magnifying viewing optic',
                        rel: ['Mounts-In-FocusTube', 'Interfaces-With-Eye'],
                        spec: { focalLength: 25, fieldOfView: 50 },
                        beh: ['Magnifies-Image', 'Projects-To-Eye']
                    },
                    {
                        id: 'FocusRod',
                        type: 'Object',
                        def: 'Precision adjustment mechanism',
                        rel: ['Connects-To-FocusTube', 'Accepts-User-Input'],
                        spec: { threadPitch: 0.5, material: 'Brass' },
                        beh: ['Translates-Rotation-To-Linear', 'Provides-Fine-Control']
                    }
                ],
                relationships: [
                    { from: 'Eyepiece', to: 'FocusTube', type: 'Mounts-In-FocusTube ‚ü∑ Houses-Eyepiece' },
                    { from: 'FocusRod', to: 'FocusTube', type: 'Connects-To-FocusTube ‚ü∑ Slides-In-Body' }
                ],
                constraints: [
                    { name: 'Focus travel covers range', check: (c) => c.FocusTube.spec.travelRange >= 30 },
                    { name: 'Precision sufficient', check: (c) => c.FocusTube.spec.precision <= 0.5 }
                ],
                emergentBehaviors: [
                    'Magnifies-Distant-Objects (Objective + Eyepiece)',
                    'Enables-Focus-Adjustment (Rod ‚Üí Tube ‚Üí Eyepiece)',
                    'Calculates-Magnification = ObjectiveFocal / EyepieceFocal'
                ],
                contextUpdate: {
                    FocusRod: 'Role: Focus-Adjustment-Mechanism',
                    FocusTube: 'Role: Position-Controller',
                    Eyepiece: 'Role: Output-Interface'
                }
            },
            engine: {
                name: 'Engine Block',
                targetSymbol: 'CombustionEngine',
                components: [
                    {
                        id: 'Cylinder',
                        type: 'Object',
                        def: 'Combustion chamber',
                        rel: ['Houses-Piston', 'Receives-Fuel-Air'],
                        spec: { bore: 80, stroke: 90, compression: 10 },
                        beh: ['Contains-Combustion', 'Guides-Piston']
                    },
                    {
                        id: 'Piston',
                        type: 'Object',
                        def: 'Reciprocating force transmitter',
                        rel: ['Fits-In-Cylinder', 'Connects-To-Rod'],
                        spec: { diameter: 79.5, material: 'Aluminum' },
                        beh: ['Compresses-Mixture', 'Transmits-Force']
                    },
                    {
                        id: 'ConnectingRod',
                        type: 'Object',
                        def: 'Linear-to-rotary converter',
                        rel: ['Attaches-To-Piston', 'Drives-Crankshaft'],
                        spec: { length: 150, material: 'Steel' },
                        beh: ['Converts-Motion', 'Bears-Combustion-Force']
                    },
                    {
                        id: 'Crankshaft',
                        type: 'Object',
                        def: 'Rotational output shaft',
                        rel: ['Receives-Rod-Force', 'Outputs-Torque'],
                        spec: { throws: 1, material: 'Forged-Steel' },
                        beh: ['Converts-Reciprocating-To-Rotary', 'Outputs-Power']
                    }
                ],
                relationships: [
                    { from: 'Piston', to: 'Cylinder', type: 'Fits-In-Cylinder ‚ü∑ Houses-Piston' },
                    { from: 'ConnectingRod', to: 'Piston', type: 'Attaches-To-Piston ‚ü∑ Connects-To-Rod' },
                    { from: 'ConnectingRod', to: 'Crankshaft', type: 'Drives-Crankshaft ‚ü∑ Receives-Rod-Force' }
                ],
                constraints: [
                    { name: 'Piston fits cylinder', check: (c) => c.Piston.spec.diameter < c.Cylinder.spec.bore },
                    { name: 'Clearance valid', check: (c) => (c.Cylinder.spec.bore - c.Piston.spec.diameter) < 1 }
                ],
                emergentBehaviors: [
                    'Converts-Chemical-To-Mechanical-Energy',
                    'Generates-Torque ‚àù Combustion-Pressure √ó Stroke',
                    'Four-Stroke-Cycle (Intake‚ÜíCompress‚ÜíPower‚ÜíExhaust)'
                ],
                contextUpdate: {
                    Piston: 'Role: Pressure-Receiver',
                    ConnectingRod: 'Role: Motion-Converter',
                    Crankshaft: 'Role: Power-Output'
                }
            }
        };

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // ASSEMBLY ENGINE
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        class AssemblyEngine {
            constructor() {
                this.reset();
            }

            reset() {
                this.log = [];
                this.currentStage = 0;
                this.isRunning = false;
                this.constraintResults = [];
                this.assembledSymbol = null;
            }

            logEntry(skill, message) {
                this.log.push({ skill, message, time: Date.now() });
                this.renderLog();
            }

            async runAssembly(scenario) {
                this.reset();
                this.isRunning = true;

                this.logEntry('SYS', `Starting assembly of ${scenario.targetSymbol}`);
                this.updateStage(0);
                await this.delay(500);

                // Stage 1: Relationship Integration
                this.updateStage(1);
                await this.R_int(scenario);

                // Stage 2: Specification Harmonization
                this.updateStage(2);
                const specValid = await this.S_harm(scenario);

                if (!specValid) {
                    this.logEntry('SYS', '‚ùå Assembly failed: Specification conflicts');
                    this.isRunning = false;
                    return null;
                }

                // Stage 3: Emergent Behavior Prediction
                this.updateStage(3);
                await this.B_pred(scenario);

                // Stage 4: Recursive ID Propagation
                this.updateStage(4);
                await this.I_prop(scenario);

                // Stage 5: Complete
                this.updateStage(5);
                this.assembledSymbol = {
                    id: scenario.targetSymbol,
                    components: scenario.components.map(c => c.id),
                    behaviors: scenario.emergentBehaviors,
                    architecture: scenario.relationships
                };

                this.logEntry('SYS', `‚úì Assembly complete: ${scenario.targetSymbol}`);
                this.renderResult(scenario);
                this.isRunning = false;

                return this.assembledSymbol;
            }

            // Skill 1: Relationship Integration
            async R_int(scenario) {
                this.logEntry('R', `‚Ñõ_int: Analyzing ${scenario.relationships.length} relationships`);
                await this.delay(300);

                for (const rel of scenario.relationships) {
                    this.logEntry('R', `  ${rel.from} ‚ü∑ ${rel.to}`);
                    this.logEntry('R', `    Type: ${rel.type}`);
                    await this.delay(200);
                }

                this.logEntry('R', `‚úì Architecture established`);
                this.renderRelationshipGraph(scenario);
            }

            // Skill 2: Specification Harmonization
            async S_harm(scenario) {
                this.logEntry('S', `ùíÆ_harm: Validating constraints`);
                await this.delay(300);

                const componentMap = {};
                scenario.components.forEach(c => componentMap[c.id] = c);

                let allValid = true;
                this.constraintResults = [];

                for (const constraint of scenario.constraints) {
                    const result = constraint.check(componentMap);
                    this.constraintResults.push({
                        name: constraint.name,
                        pass: result
                    });

                    this.logEntry('S', `  ${result ? '‚úì' : '‚úó'} ${constraint.name}`);
                    if (!result) allValid = false;
                    await this.delay(200);
                }

                this.renderConstraints();

                if (allValid) {
                    this.logEntry('S', `‚úì All specifications harmonized`);
                } else {
                    this.logEntry('S', `‚úó Specification conflicts detected`);
                }

                return allValid;
            }

            // Skill 3: Emergent Behavior Prediction
            async B_pred(scenario) {
                this.logEntry('B', `‚Ñ¨_pred: Synthesizing emergent behaviors`);
                await this.delay(300);

                for (const behavior of scenario.emergentBehaviors) {
                    this.logEntry('B', `  ‚ö° ${behavior}`);
                    await this.delay(250);
                }

                this.logEntry('B', `‚úì ${scenario.emergentBehaviors.length} behaviors predicted`);
            }

            // Skill 4: Recursive ID Propagation
            async I_prop(scenario) {
                this.logEntry('I', `‚Ñê_prop: Propagating identity to components`);
                await this.delay(300);

                for (const [compId, role] of Object.entries(scenario.contextUpdate)) {
                    this.logEntry('I', `  ùíû(${compId}) ‚Üê {${role}}`);
                    await this.delay(200);
                }

                this.logEntry('I', `‚úì Context updated for all components`);
            }

            updateStage(stage) {
                this.currentStage = stage;
                document.querySelectorAll('.pipeline-stage').forEach((el, i) => {
                    el.classList.remove('active', 'completed');
                    if (i < stage) el.classList.add('completed');
                    if (i === stage) el.classList.add('active');
                });
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            renderLog() {
                const container = document.getElementById('assemblyLog');
                container.innerHTML = this.log.map(entry => `
                    <div class="log-entry">
                        <span class="log-skill ${entry.skill.toLowerCase()}">${entry.skill}</span>
                        <span class="log-message">${entry.message}</span>
                    </div>
                `).join('');
                container.scrollTop = container.scrollHeight;
            }

            renderConstraints() {
                const container = document.getElementById('constraintList');
                container.innerHTML = this.constraintResults.map(c => `
                    <div class="constraint-item">
                        <div class="constraint-status ${c.pass ? 'pass' : 'fail'}">${c.pass ? '‚úì' : '‚úó'}</div>
                        <span class="constraint-name">${c.name}</span>
                    </div>
                `).join('');
            }

            renderResult(scenario) {
                const container = document.getElementById('resultContainer');
                const symbol = document.getElementById('resultSymbol');

                container.style.display = 'block';
                symbol.innerHTML = `
                    <div class="result-symbol-name">${scenario.targetSymbol}</div>
                    <div class="result-behaviors">
                        ${scenario.emergentBehaviors.map(b => `<span class="result-behavior">${b.split(' ')[0]}</span>`).join('')}
                    </div>
                `;
            }

            renderComponents(scenario) {
                const container = document.getElementById('componentViz');
                container.innerHTML = scenario.components.map(c => `
                    <div class="component-item" id="comp-${c.id}">
                        <div class="component-header">
                            <span class="component-name">${c.id}</span>
                            <span class="component-type">${c.type}</span>
                        </div>
                        <div class="component-meta">
                            Rel: ${c.rel.slice(0, 2).join(', ')}${c.rel.length > 2 ? '...' : ''}
                        </div>
                    </div>
                `).join('');
            }

            renderRelationshipGraph(scenario) {
                const canvas = document.getElementById('relGraph');
                const ctx = canvas.getContext('2d');

                canvas.width = canvas.clientWidth;
                canvas.height = 200;

                ctx.fillStyle = '#10101a';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Simple node layout
                const nodes = {};
                const nodeCount = scenario.components.length;
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const radius = Math.min(canvas.width, canvas.height) * 0.35;

                scenario.components.forEach((comp, i) => {
                    const angle = (i / nodeCount) * Math.PI * 2 - Math.PI / 2;
                    nodes[comp.id] = {
                        x: centerX + Math.cos(angle) * radius,
                        y: centerY + Math.sin(angle) * radius
                    };
                });

                // Draw edges
                ctx.strokeStyle = 'rgba(179, 136, 255, 0.3)';
                ctx.lineWidth = 1;
                for (const rel of scenario.relationships) {
                    const from = nodes[rel.from];
                    const to = nodes[rel.to];
                    if (from && to) {
                        ctx.beginPath();
                        ctx.moveTo(from.x, from.y);
                        ctx.lineTo(to.x, to.y);
                        ctx.stroke();
                    }
                }

                // Draw nodes
                for (const [id, pos] of Object.entries(nodes)) {
                    ctx.fillStyle = 'var(--bg-3)';
                    ctx.strokeStyle = 'var(--psi)';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(pos.x, pos.y, 20, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.stroke();

                    ctx.fillStyle = '#fff';
                    ctx.font = '9px monospace';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(id.substring(0, 6), pos.x, pos.y);
                }
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // UI INITIALIZATION
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        const engine = new AssemblyEngine();
        let currentScenario = 'door';

        function loadScenario(scenarioId) {
            currentScenario = scenarioId;
            const scenario = SCENARIOS[scenarioId];

            engine.reset();
            engine.renderComponents(scenario);
            engine.renderRelationshipGraph(scenario);

            document.getElementById('assemblyLog').innerHTML = '';
            document.getElementById('constraintList').innerHTML = '';
            document.getElementById('resultContainer').style.display = 'none';

            document.querySelectorAll('.pipeline-stage').forEach(el => {
                el.classList.remove('active', 'completed');
            });
        }

        // Event Listeners
        document.querySelectorAll('.scenario-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.scenario-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                loadScenario(btn.dataset.scenario);
            });
        });

        document.getElementById('btnAssemble').addEventListener('click', () => {
            const scenario = SCENARIOS[currentScenario];
            engine.runAssembly(scenario);
        });

        document.getElementById('btnReset').addEventListener('click', () => {
            loadScenario(currentScenario);
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadScenario('door');

            renderMathInElement(document.body, {
                delimiters: [
                    { left: '$$', right: '$$', display: true },
                    { left: '$', right: '$', display: false }
                ],
                throwOnError: false
            });
        });
    </script>
</body>
</html>
